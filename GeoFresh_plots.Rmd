---
title: "GeoFresh"
subtitle: ""
author: ""
date: "`r Sys.Date()`"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:


# install Tidyverse-Package 
# load all libaries
```{r}
library(readr)
library(tibble)
library(ggplot2)
library(leaflet)
library(dplyr)

```
# read CSV data 
```{r}
(tutorial_points <- read_csv("data/tutorial_points.csv"))
```
# create a Map with Leaflet 
```{r}
m <- leaflet(tutorial_points)
m <- addTiles(m)
m <- m %>%
  addMarkers(
    lng = ~decimalLongitude,  
    lat = ~decimalLatitude,
    popup = ~paste("gbifID ", gbifID)
  )
  m                            
```

# load Geo-Fresh CSV-Data

```{r}
(climate_local <- read_csv("U:/R-Studio/geofresh_plots/data/geofresh-2023-11-13-env-var-climate-local.csv"))
```

```{r}
(climate_upstream <- read_csv("U:/R-Studio/geofresh_plots/data/geofresh-2023-11-13-env-var-climate-upstream.csv"))
```

```{r}
(landcover_local <- read_csv("U:/R-Studio/geofresh_plots/data/geofresh-2023-11-13-env-var-land-cover-local.csv"))
```

```{r}
(landcover_upstream <- read_csv("U:/R-Studio/geofresh_plots/data/geofresh-2023-11-13-env-var-land-cover-upstream.csv"))
```

```{r}
(soil_local <- read_csv("U:/R-Studio/geofresh_plots/data/geofresh-2023-11-13-env-var-soil-local.csv"))
```

```{r}
(soil_upstream <- read_csv("U:/R-Studio/geofresh_plots/data/geofresh-2023-11-13-env-var-soil-upstream.csv"))
```

```{r}
(topography_local <- read_csv("U:/R-Studio/geofresh_plots/data/geofresh-2023-11-13-env-var-topography-local.csv"))
```

```{r}
(topography_upstream <- read_csv("U:/R-Studio/geofresh_plots/data/geofresh-2023-11-13-env-var-topography-upstream.csv"))
```

# filter by mean  
```{r}
climate_local_filtered <- climate_local %>%
  select(bio1_mean,bio2_mean,bio3_mean,bio4_mean,bio5_mean,bio6_mean,bio7_mean,bio8_mean,bio9_mean,bio10_mean,bio11_mean,bio12_mean,bio13_mean,bio14_mean,bio15_mean,bio16_mean,bio17_mean,bio18_mean,bio19_mean)

print(climate_local_filtered)
```

```{r}
climate_upstream_filtered <- climate_upstream %>%
  select(bio1_mean,bio2_mean,bio3_mean,bio4_mean,bio5_mean,bio6_mean,bio7_mean,bio8_mean,bio9_mean,bio10_mean,bio11_mean,bio12_mean,bio13_mean,bio14_mean,bio15_mean,bio16_mean,bio17_mean,bio18_mean,bio19_mean)

print(climate_upstream_filtered)
```

# create histograms for climate_local and climate_upstream
```{r}
# climate_local
# Create histograms for each column and display them in a row
par(mfrow = c(1, 2))  

for (col_name in names(climate_local_filtered)) {
  hist(climate_local_filtered[[col_name]],
       main = paste("Histogram for", col_name),
       xlab = col_name,
       col = "skyblue",
       border = "black")
}
```

```{r}
# climate_upstream
par(mfrow = c(1, 2))  

for (col_name in names(climate_upstream_filtered)) {
  hist(climate_upstream_filtered[[col_name]],
       main = paste("Histogram for", col_name),
       xlab = col_name,
       col = "skyblue",
       border = "black")
}
```

# filter by mean and continuous 
```{r}
topography_local_filtered <- topography_local %>%
  select(elev_mean,flowpos_mean,spi_mean,sti_mean,cti_mean)

print(topography_local_filtered)
```
```{r}
topography_upstream_filtered <- topography_upstream %>%
  select(elev_mean,flowpos_mean,spi_mean,sti_mean,cti_mean)

print(topography_upstream_filtered)
```

# Create histograms for topography_local and topography_upstream
```{r}
# topography_local
par(mfrow = c(1, 2))  

for (col_name in names(topography_local_filtered)) {
  hist(topography_local_filtered[[col_name]],
       main = paste("Histogram for", col_name),
       xlab = col_name,
       col = "skyblue",
       border = "black")
}
```

```{r}
# topography_upstream
par(mfrow = c(1, 2))  

for (col_name in names(topography_upstream_filtered)) {
  hist(topography_upstream_filtered[[col_name]],
       main = paste("Histogram for", col_name),
       xlab = col_name,
       col = "skyblue",
       border = "black")
}
```

# create boxplots for landcover_local
```{r}
ggplot(stack(landcover_local[ ,3:24]), aes(x = factor(ind, levels = names(landcover_local)), y = values)) + 
  geom_boxplot()
```

# load environmental_variables CSV-Data 
```{r}
(environmental_variables <- read_csv("U:/R-Studio/geofresh_plots/data/geofresh_environmental_variables - env_var_for_plots.csv"))
```

# copy landcover local and multiply all columns with 100
```{r}
landcover_local_copy <- landcover_local

landcover_local_copy <- landcover_local_copy %>%
  mutate_at(vars(c10:c220), ~ . * 100)


print(landcover_local_copy)

```


# labelling of the x-axis exchanged with the data from environmental_variables (lines 81-102)
# set scale limit from the y-axis to 100
```{r}
selected_values <- environmental_variables$Variable[81:102]
ggplot(stack(landcover_local_copy[ ,3:24]), aes(x = factor(ind, levels = names(landcover_local_copy)), y = values)) +
  geom_boxplot() +
  scale_x_discrete(name = "Landcover local", labels = selected_values, guide = guide_axis(angle = 60)) + ylim(0.00, 100)
```

# copy landcover_upstream and multiply all columns with 100
```{r}
landcover_upstream_copy <- landcover_upstream

landcover_upstream_copy <- landcover_upstream_copy %>%
  mutate_at(vars(c10:c220), ~ . * 100)

print(landcover_upstream_copy)
```

# create boxplots for landcover_upstream_copy
```{r}
selected_values <- environmental_variables$Variable[81:102]

ggplot(stack(landcover_upstream_copy[ ,3:24]), aes(x = factor(ind, levels = names(landcover_upstream_copy)), y = values)) +
  geom_boxplot() +
  scale_x_discrete(name = "Landcover upstream", labels = selected_values, guide = guide_axis(angle = 60)) + ylim(0.00, 100)
```


# create histograms for soil_local and soil_upstream
```{r}
# soil_local
par(mfrow = c(1, 2))  

for (col_name in names(soil_local)) {
  hist(soil_local[[col_name]],
       main = paste("Histogram for", col_name),
       xlab = col_name,
       col = "skyblue",
       border = "black")
}
```

```{r}
# soil_upstream
par(mfrow = c(1, 2))  

for (col_name in names(soil_upstream)) {
  hist(soil_upstream[[col_name]],
       main = paste("Histogram for", col_name),
       xlab = col_name,
       col = "skyblue",
       border = "black")
}
```

# create boxplots for the columns clyppt (Clay content), sndppt (Sand content), sltppt (Silt content) from soil_local 
```{r}
soil_local_filtered <- soil_local %>%
  select(clyppt_mean,sndppt_mean,sltppt_mean)

selected_values <- environmental_variables$Variable[67:69]

ggplot(stack(soil_local_filtered), aes(x = factor(ind, levels = names(soil_local_filtered)), y = values)) + 
  geom_boxplot()+
  scale_x_discrete(name = "Soil local (Clay content, Sand content, Silt content)", labels = selected_values, guide = guide_axis(angle = 60)) + ylim(0.00, 100)

```

# searched climate_local for unique and not unique values 
```{r}
unique_subc_id <- unique(climate_local$subc_id)

print(unique_subc_id)
```
# no unique values in climate_local 
```{r}
not_unique_subc_id <- table(as.character(climate_local$subc_id))

duplicated_values <- as.numeric(names(not_unique_subc_id [not_unique_subc_id > 1]))

print(duplicated_values)
```

# Diagram for the frequency of strahler numbers in topography_local
```{r}
frequencies <- table(topography_local$strahler)

max_frequencies <- max(frequencies)

barplot(table(topography_local$strahler),
        main = "Frequency of the flow order numbers",
        xlab = "Strahler (flow order numbers)",
        ylab = "Frequency",
        col = "skyblue",
        border = "black",
        ylim = c(0, max_frequencies + 5))
```
 
 